<?xml version="1.0" ?>
<!-- =================================================================================== -->
<!-- |    This document was autogenerated by xacro from ferrari.xacro                  | -->
<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED                                 | -->
<!-- =================================================================================== -->
<robot name="steering_robot">
  <!--0.95-->
  <!-- Wheel Properties -->
  <!--
  <xacro:wheel  wheel_prefix="monoruota" parent_link="ciao" left_right="-1"/>
  -->
  <gazebo reference="rear_right_wheel_joint">
    <mu1>1000000</mu1>
    <mu2>1000000</mu2>
    <kp>10000000</kp>
    <!--kp is surface elasticity-->
    <kd>100</kd>
    <!-- kd is damping-->
    <minDepth>0.01</minDepth>
    <maxVel>1000.0</maxVel>
  </gazebo>
  <gazebo reference="rear_left_wheel_joint">
    <mu1>100000000</mu1>
    <mu2>100000000</mu2>
    <kp>10000000</kp>
    <kd>100</kd>
    <minDepth>0.01</minDepth>
    <maxVel>1000.0</maxVel>
  </gazebo>
  <gazebo reference="front_right_steering_wheel_joint">
    <mu1>100000000</mu1>
    <mu2>100000000</mu2>
    <kp>1000000</kp>
    <kd>100</kd>
    <minDepth>0.01</minDepth>
    <maxVel>1000.0</maxVel>
  </gazebo>
  <gazebo reference="front_left_steering_wheel_joint">
    <mu1>100000000</mu1>
    <mu2>100000000</mu2>
    <kp>1000000</kp>
    <kd>100</kd>
    <minDepth>0.01</minDepth>
    <maxVel>1000.0</maxVel>
  </gazebo>
  <gazebo reference="front_right_steering_joint">
    <mu1>100000000</mu1>
    <mu2>100000000</mu2>
    <kp>1000000</kp>
    <kd>0.1</kd>
    <minDepth>0.01</minDepth>
    <maxVel>1000.0</maxVel>
  </gazebo>
  <gazebo reference="front_left_steering_joint">
    <mu1>100000000</mu1>
    <mu2>100000000</mu2>
    <kp>1000000</kp>
    <kd>0.1</kd>
    <minDepth>0.01</minDepth>
    <maxVel>1000.0</maxVel>
  </gazebo>
  <gazebo>
    <plugin filename="libgazebo_ros_control.so" name="gazebo_ros_control">
      <robotNamespace>/steering_robot</robotNamespace>
      <robotSimType>gazebo_ros_control/DefaultRobotHWSim</robotSimType>
      <legacyModeNS>true</legacyModeNS>
    </plugin>
  </gazebo>
  <gazebo>
    <plugin filename="libgazebo_ros_joint_state_publisher.so" name="joint_state_publisher">
      <jointName>rear_right_wheel_joint, rear_left_wheel_joint, front_right_steering_joint, front_left_steering_joint, front_right_steering_wheel_joint, front_left_steering_wheel_joint</jointName>
      <updateRate>50.0</updateRate>
      <robotNamespace>/steering_robot</robotNamespace>
      <alwaysOn>true</alwaysOn>
    </plugin>
  </gazebo>
  <gazebo>
    <plugin filename="libcatvehiclegazebo.so" name="cmdvel_controller">
      <robotNamespace>/steering_robot</robotNamespace>
    </plugin>
  </gazebo>
  <!-- parametri costruttivi -->
  <!--#####################################-->
  <!--chassis-->
  <!--#####################################-->
  <!--definizione dei colori-->
  <!-- Base link is the center of the robot's bottom plate -->
  <link name="ferrari_chassis">
    <!--caratteristiche inerziali-->
    <inertial>
      <mass value="800"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="616.6666666666666" ixy="0" ixz="0" iyy="139.4299333333333" iyz="0" izz="722.7632666666667"/>
      <!-- <inertia ixx="2581.13354740" ixy="0.0" ixz="0.0" iyy="591.30846112" iyz="0.0" izz="2681.95008628"/> -->
    </inertial>
    <!--caratteristiche visuali-->
    <visual>
      <origin rpy="0 0 0" xyz="0 0  0.7"/>
      <geometry>
        <box size="1.357 3 0.5"/>
      </geometry>
    </visual>
    <visual>
      <origin rpy="0 0 0" xyz="0 0  1.2"/>
      <geometry>
        <box size="1.357 1.0 0.5"/>
      </geometry>
    </visual>
    <!--bombatura laterale-->
    <visual>
      <origin rpy="0 0 0" xyz="0 0  0.7"/>
      <geometry>
        <box size="1.557 2.0 0.5"/>
      </geometry>
    </visual>
    <visual>
      <origin rpy="0 0 0" xyz="0 0  0.7"/>
      <geometry>
        <box size="1.7570000000000001 1.5 0.5"/>
      </geometry>
    </visual>
    <!--alettone posteriore-->
    <visual>
      <origin rpy="0 0 0" xyz="0.5 1.4  1.05"/>
      <geometry>
        <box size="0.1 0.1 0.3"/>
      </geometry>
    </visual>
    <visual>
      <origin rpy="0 0 0" xyz="-0.5 1.4  1.05"/>
      <geometry>
        <box size="0.1 0.1 0.3"/>
      </geometry>
    </visual>
    <visual>
      <origin rpy="0 0 0" xyz="0 1.4  1.25"/>
      <geometry>
        <box size="1.357 0.2 0.1"/>
      </geometry>
    </visual>
    <!--parabrezza-->
    <visual>
      <origin rpy="0.6 0 0" xyz="0 -1.0  1.05"/>
      <geometry>
        <box size="1.357 1.357 0.1"/>
      </geometry>
    </visual>
    <!--vetro posteriore-->
    <visual>
      <origin rpy="-0.8 0 0" xyz="0 0.75  1.05"/>
      <geometry>
        <box size="1.357 0.8785000000000001 0.1"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0  0.7"/>
      <geometry>
        <box size="1.357 3 0.5"/>
      </geometry>
    </collision>
    <collision>
      <origin rpy="0 0 0" xyz="0 0  1.2"/>
      <geometry>
        <box size="1.357 1.5 0.5"/>
      </geometry>
    </collision>
  </link>
  <!--inserisci colori-->
  <gazebo reference="ferrari_chassis">
    <material>Gazebo/Red</material>
  </gazebo>
  <!--#####################################-->
  <!--map link -->
  <!--#####################################-->
  <link name="map">
  </link>
  <joint name="map_joint" type="fixed">
    <parent link="map"/>
    <child link="ferrari_chassis"/>
  </joint>
  <!--#####################################-->
  <!--rear axle -->
  <!--#####################################-->
  <link name="rear_axle">
    <inertial>
      <mass value="30.0"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="6.442187500000002" ixy="0" ixz="0" iyy="6.442187500000002" iyz="0" izz="0.08437499999999999"/>
    </inertial>
    <visual>
      <origin rpy="0      1.57079 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="1.6" radius="0.075"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0      1.57079 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="1.6" radius="0.075"/>
      </geometry>
    </collision>
  </link>
  <!--joint che collega lo chassis all'asse posteriore del veicolo -->
  <joint name="rear_axle_joint" type="fixed">
    <parent link="ferrari_chassis"/>
    <child link="rear_axle"/>
    <origin rpy="0 0 0" xyz="0   1.45 0.33"/>
    <axis xyz="1 0 0"/>
  </joint>
  <!--#####################################-->
  <!--fixed wheels posteriori-->
  <!--#####################################-->
  <!-- right = -1 ...left = 1 -->
  <link name="rear_right_wheel">
    <inertial>
      <mass value="30"/>
      <origin xyz="0 0 0"/>
      <inertia ixx="0.9167500000000001" ixy="0" ixz="0" iyy="0.9167500000000001" iyz="0" izz="1.6335000000000002"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://autopark/urdf/meshes/wheel.dae" scale="0.01 0.01 0.01"/>
        <!-- <cylinder length="${wheel_length}" radius="${wheel_radius}" /> -->
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 1.570796327 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.2" radius="0.33"/>
      </geometry>
      <surface>
        <friction>
          <ode>
            <mu>10000000</mu>
            <mu2>7000</mu2>
          </ode>
        </friction>
        <bounce>
          <restitution_coefficient>0.0</restitution_coefficient>
        </bounce>
        <contact>
          <ode>
            <soft_cfm>0.001</soft_cfm>
            <soft_erp>0.5</soft_erp>
            <kp>10000000</kp>
            <kd>1</kd>
          </ode>
        </contact>
      </surface>
    </collision>
  </link>
  <gazebo reference="rear_right_wheel">
    <material>Gazebo/Black</material>
    <turnGravityOff>False</turnGravityOff>
  </gazebo>
  <joint name="rear_right_wheel_joint" type="continuous">
    <parent link="rear_axle"/>
    <child link="rear_right_wheel"/>
    <origin rpy="0 0 0" xyz="-0.8  0 0"/>
    <axis xyz="1 0 0"/>
    <dynamics damping="0.01"/>
    <limit effort="10000" velocity="1000"/>
    <joint_properties damping="10" friction="10.0"/>
  </joint>
  <link name="rear_left_wheel">
    <inertial>
      <mass value="30"/>
      <origin xyz="0 0 0"/>
      <inertia ixx="0.9167500000000001" ixy="0" ixz="0" iyy="0.9167500000000001" iyz="0" izz="1.6335000000000002"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://autopark/urdf/meshes/wheel.dae" scale="0.01 0.01 0.01"/>
        <!-- <cylinder length="${wheel_length}" radius="${wheel_radius}" /> -->
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 1.570796327 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.2" radius="0.33"/>
      </geometry>
      <surface>
        <friction>
          <ode>
            <mu>10000000</mu>
            <mu2>7000</mu2>
          </ode>
        </friction>
        <bounce>
          <restitution_coefficient>0.0</restitution_coefficient>
        </bounce>
        <contact>
          <ode>
            <soft_cfm>0.001</soft_cfm>
            <soft_erp>0.5</soft_erp>
            <kp>10000000</kp>
            <kd>1</kd>
          </ode>
        </contact>
      </surface>
    </collision>
  </link>
  <gazebo reference="rear_left_wheel">
    <material>Gazebo/Black</material>
    <turnGravityOff>False</turnGravityOff>
  </gazebo>
  <joint name="rear_left_wheel_joint" type="continuous">
    <parent link="rear_axle"/>
    <child link="rear_left_wheel"/>
    <origin rpy="0 0 0" xyz="0.8  0 0"/>
    <axis xyz="1 0 0"/>
    <dynamics damping="0.01"/>
    <limit effort="10000" velocity="1000"/>
    <joint_properties damping="10" friction="10.0"/>
  </joint>
  <!-- Transmission rear right wheel -->
  <transmission name="rear_right_wheel_joint_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="rear_right_wheel_joint">
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </joint>
    <actuator name="rear_right_wheel_joint_motor">
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>
  <!-- Transmission rear left wheel -->
  <transmission name="rear_left_wheel_joint_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="rear_left_wheel_joint">
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </joint>
    <actuator name="rear_left_wheel_joint_motor">
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>
  <!--#####################################-->
  <!--left link sterzante -->
  <!--#####################################-->
  <link name="front_left_steering">
    <inertial>
      <mass value="50"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="0.4166666666666668" ixy="0" ixz="0" iyy="0.08333333333333336" iyz="0" izz="0.4166666666666668"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.1 0.30000000000000004 0.1"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.1 0.30000000000000004 0.1"/>
      </geometry>
    </collision>
  </link>
  <joint name="front_left_steering_joint" type="revolute">
    <limit effort="10000.0" lower="-0.6" upper="0.6" velocity="1000"/>
    <axis xyz="0 0 1"/>
    <parent link="ferrari_chassis"/>
    <child link="front_left_steering"/>
    <origin rpy="0 0 0" xyz="0.5 -1.4  0.33"/>
    <!-- <origin xyz="${+lunghezza_asse_posteriore/2} ${-posizione_y_asse_posteriore + 0.05}  ${posizione_z_asse_posteriore}" rpy="0 0 0"/> -->
  </joint>
  <!--inserisco la trasmissione-->
  <transmission name="front_left_steering_joint_trasm">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="front_left_steering_joint">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
    </joint>
    <actuator name="front_left_steering_joint_motor">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>
  <!--#####################################-->
  <!--right_link sterzante -->
  <!--#####################################-->
  <link name="front_right_steering">
    <inertial>
      <mass value="50"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="0.4166666666666668" ixy="0" ixz="0" iyy="0.08333333333333336" iyz="0" izz="0.4166666666666668"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.1 0.30000000000000004 0.1"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.1 0.30000000000000004 0.1"/>
      </geometry>
    </collision>
  </link>
  <joint name="front_right_steering_joint" type="revolute">
    <limit effort="10000.0" lower="-0.6" upper="0.6" velocity="1000.0"/>
    <axis xyz="0 0 1"/>
    <parent link="ferrari_chassis"/>
    <child link="front_right_steering"/>
    <origin rpy="0 0 0" xyz="-0.5 -1.4  0.33"/>
    <!-- <origin xyz="${-lunghezza_asse_posteriore/2} ${-posizione_y_asse_posteriore + 0.05}  ${posizione_z_asse_posteriore}" rpy="0 0 0"/> -->
  </joint>
  <!--inserisco la trasmissione-->
  <transmission name="front_right_steering_joint_trasm">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="front_right_steering_joint">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
    </joint>
    <actuator name="front_right_steering_joint_motor">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>
  <!--#####################################-->
  <!--wheels_sterzanti-->
  <!--#####################################-->
  <link name="front_right_steering_wheel">
    <inertial>
      <mass value="30"/>
      <origin xyz="0 0 0"/>
      <inertia ixx="0.9167500000000001" ixy="0" ixz="0" iyy="0.9167500000000001" iyz="0" izz="1.6335000000000002"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://autopark/urdf/meshes/wheel.dae" scale="0.01 0.01 0.01"/>
        <!-- <cylinder length="${wheel_length}" radius="${wheel_radius}" /> -->
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 1.570796327 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.2" radius="0.33"/>
      </geometry>
      <surface>
        <friction>
          <ode>
            <mu>10000000</mu>
            <mu2>7000</mu2>
          </ode>
        </friction>
        <bounce>
          <restitution_coefficient>0.0</restitution_coefficient>
        </bounce>
        <contact>
          <ode>
            <soft_cfm>0.001</soft_cfm>
            <soft_erp>0.5</soft_erp>
            <kp>10000000</kp>
            <kd>1</kd>
          </ode>
        </contact>
      </surface>
    </collision>
  </link>
  <gazebo reference="front_right_steering_wheel">
    <material>Gazebo/Black</material>
    <turnGravityOff>False</turnGravityOff>
  </gazebo>
  <joint name="front_right_steering_wheel_joint" type="continuous">
    <parent link="front_left_steering"/>
    <child link="front_right_steering_wheel"/>
    <origin rpy="0 0 0" xyz="0.3  0 0"/>
    <axis xyz="1 0 0"/>
    <dynamics damping="0.01"/>
    <limit effort="10000" velocity="1000"/>
    <joint_properties damping="10" friction="10.0"/>
  </joint>
  <link name="front_left_steering_wheel">
    <inertial>
      <mass value="30"/>
      <origin xyz="0 0 0"/>
      <inertia ixx="0.9167500000000001" ixy="0" ixz="0" iyy="0.9167500000000001" iyz="0" izz="1.6335000000000002"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://autopark/urdf/meshes/wheel.dae" scale="0.01 0.01 0.01"/>
        <!-- <cylinder length="${wheel_length}" radius="${wheel_radius}" /> -->
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 1.570796327 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.2" radius="0.33"/>
      </geometry>
      <surface>
        <friction>
          <ode>
            <mu>10000000</mu>
            <mu2>7000</mu2>
          </ode>
        </friction>
        <bounce>
          <restitution_coefficient>0.0</restitution_coefficient>
        </bounce>
        <contact>
          <ode>
            <soft_cfm>0.001</soft_cfm>
            <soft_erp>0.5</soft_erp>
            <kp>10000000</kp>
            <kd>1</kd>
          </ode>
        </contact>
      </surface>
    </collision>
  </link>
  <gazebo reference="front_left_steering_wheel">
    <material>Gazebo/Black</material>
    <turnGravityOff>False</turnGravityOff>
  </gazebo>
  <joint name="front_left_steering_wheel_joint" type="continuous">
    <parent link="front_right_steering"/>
    <child link="front_left_steering_wheel"/>
    <origin rpy="0 0 0" xyz="-0.3  0 0"/>
    <axis xyz="1 0 0"/>
    <dynamics damping="0.01"/>
    <limit effort="10000" velocity="1000"/>
    <joint_properties damping="10" friction="10.0"/>
  </joint>
  <gazebo>
    <plugin filename="libgazebo_ros_control.so" name="gazebo_ros_control"/>
  </gazebo>
  <link name="hokuyo_link">
    <visual>
      <origin rpy="0 0 3.14" xyz="0 0 0"/>
      <geometry>
        <box size="0.05 0.05 0.05"/>
      </geometry>
    </visual>
  </link>
  <joint name="hokuyo_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0.9692857142857143 0 0.7"/>
    <parent link="ferrari_chassis"/>
    <child link="hokuyo_link"/>
  </joint>
  <gazebo reference="hokuyo_link">
    <material>Gazebo/Blue</material>
    <turnGravityOff>false</turnGravityOff>
    <sensor name="head_hokuyo_sensor" type="ray">
      <pose>0.025 0 0 0 0 0</pose>
      <visualize>true</visualize>
      <update_rate>40</update_rate>
      <ray>
        <scan>
          <horizontal>
            <samples>720</samples>
            <resolution>1</resolution>
            <min_angle>-1.570796</min_angle>
            <max_angle>1.570796</max_angle>
          </horizontal>
        </scan>
        <range>
          <min>0.10</min>
          <max>8.0</max>
          <resolution>0.001</resolution>
        </range>
      </ray>
      <plugin filename="libgazebo_ros_laser.so" name="gazebo_ros_head_hokuyo_controller">
        <topicName>/scan</topicName>
        <frameName>hokuyo_link</frameName>
      </plugin>
    </sensor>
  </gazebo>
  <!-- CAMERA -->
  
  <gazebo>
    <!-- Groundtruth plugin -->
    <plugin filename="libgazebo_ros_p3d.so" name="robot_groundtruth_sim">
      <alwaysOn>true</alwaysOn>
      <updateRate>100.0</updateRate>
      <bodyName>ferrari_chassis</bodyName>
      <topicName>ground_truth/state</topicName>
      <gaussianNoise>0.0</gaussianNoise>
      <frameName>map</frameName>
      <xyzOffsets>0 0 0</xyzOffsets>
      <rpyOffsets>0 0 0</rpyOffsets>
    </plugin>
  </gazebo>
</robot>

